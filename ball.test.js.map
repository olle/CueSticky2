{"version":3,"sources":["vector.js","ball.js","ball.test.js"],"names":["neu","a","bi","dot","v1","v2","add","sub","abs","Math","sqrt","mul","v","u","BALL_RADIUS","radius","mass","position","vec","velocity","move","ball","delta","alpha","dt","bounce","b1","b2","posDiff","velDiff","dp1","dist","bounds","force","dp2","q","b1v","b2v","wall","b","x","y","dim","vv","hv","pocket","p","describe","it","expect","toEqual"],"mappings":"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","file":"ball.test.js","sourceRoot":"../src","sourcesContent":["/**\n * A vector (math) implementation. This was the purpose of the original\n * <a href=\"https://github.com/olle/CueSticky\">CueSticky</a> implementation -\n * to explore the use of complex numbers as a representation for vectors in\n * order to express position, direction, movement and intersection detections.\n * \n * @module vector\n */\n\n/**\n * A vector represented as a complex number.\n * \n * @typedef {Object} Vector\n * @property {number} a - the real part\n * @property {number} bi - the imaginary part\n */\n\n/**\n * Creates a new vector object, as pure data.\n * \n * @param {number} a real\n * @param {number} bi imaginary\n */\nexport function neu(a, bi) {\n  return { a: a, bi: bi };\n}\n\n/**\n * Calculates the dot-product of the two given vectors.\n * \n * @param {Vector} v1\n * @param {Vector} v2\n */\nexport function dot(v1, v2) {\n  return v1.a * v2.a + v1.bi * v2.bi;\n}\n\n/**\n * Performs an addition of the two given vectors.\n * \n * @param {Vector} v1 \n * @param {Vector} v2 \n */\nexport function add(v1, v2) {\n  return neu(v1.a + v2.a, v1.bi + v2.bi);\n}\n\n/**\n * Subtracts the two given vectors.\n * \n * @param {Vector} v1 \n * @param {Vector} v2 \n */\nexport function sub(v1, v2) {\n  return neu(v1.a - v2.a, v1.bi - v2.bi);\n}\n\n/**\n * Calculates the absolute-value of the given vector.\n * \n * @param {Vector} v1 \n */\nexport function abs(v1) {\n  return Math.sqrt(v1.a * v1.a + v1.bi * v1.bi);\n}\n\n/**\n * Multiplies the given vector with the provided real number.\n * \n * @param {Vector} v\n * @param {number} u \n */\nexport function mul(v, u) {\n  return neu(v.a * u, v.bi * u);\n}\n","/**\n * A pool ball.\n */\nimport * as vec from \"./vector\";\n\nconst BALL_RADIUS = 0.029;\n\nexport function neu() {\n  return {\n    radius: BALL_RADIUS,\n    mass: BALL_RADIUS * BALL_RADIUS,\n    position: vec.neu(0, 0),\n    velocity: vec.neu(0, 0)\n  };\n}\n\nexport function move(ball, delta, alpha) {\n  let dt = vec.mul(ball.velocity, delta);\n  let pos = vec.add(ball.position, dt);\n  let vel = vec.mul(ball.velocity, alpha);\n  return { ...ball, position: pos, velocity: vel };\n}\n\nexport function bounce(b1, b2) {\n  var posDiff = vec.sub(b2.position, b1.position);\n  var velDiff = vec.sub(b2.velocity, b1.velocity);\n  var dp1 = vec.dot(velDiff, posDiff);\n  var dist = vec.abs(vec.sub(b1.position, b2.position));\n  var bounds = b2.radius + b1.radius;\n  if (dp1 < 0 && dist < bounds) {\n    var force = (2 * b2.mass) / (b1.mass + b2.mass);\n    var dp2 = vec.dot(velDiff, posDiff) / vec.dot(posDiff, posDiff);\n    var q = vec.mul(posDiff, dp2);\n    var b1v = vec.add(b1.velocity, vec.mul(q, force));\n    var b2v = vec.sub(b2.velocity, vec.mul(q, force));\n    return [{ ...b1, velocity: b1v }, { ...b2, velocity: b2v }];\n  }\n  return [b1, b2];\n}\n\nexport function wall(b, x, y, dim) {\n  var vv = b.velocity.bi;\n  var hv = b.velocity.a;\n  if (\n    (b.position.bi - b.radius < dim && vv < 0) ||\n    (b.position.bi + b.radius > y - dim && vv > 0)\n  ) {\n    return { ...b, velocity: { ...b.velocity, bi: -vv } };\n  } else if (\n    (b.position.a - b.radius < dim && hv < 0) ||\n    (b.position.a + b.radius > x - dim && hv > 0)\n  ) {\n    return { ...b, velocity: { ...b.velocity, a: --hv } };\n  }\n}\n\nexport function pocket(b, p) {\n  return vec.abs(vec.sub(b.position, p.position)) < p.radius;\n}\n","import { neu, move, collide } from \"./ball\";\n\ndescribe(\"ball\", () => {\n  it(\"has a default radius\", () => {\n    let b = neu();\n    expect(b.radius).toEqual(0.029);\n  });\n\n  it(\"has a mass that is radius squared\", () => {\n    let b = neu();\n    expect(b.mass).toEqual(b.radius * b.radius);\n  });\n\n  it(\"has a default position vector\", () => {\n    let b = neu();\n    expect(b.position).toEqual({ a: 0, bi: 0 });\n  });\n\n  it(\"has a default velocity vector\", () => {\n    let b = neu();\n    expect(b.velocity).toEqual({ a: 0, bi: 0 });\n  });\n\n  it(\"does not move a ball without velocity\", () => {\n    var b = neu();\n    expect(b.position).toEqual({ a: 0, bi: 0 });\n    expect(b.velocity).toEqual({ a: 0, bi: 0 });\n    b = move(b, 2, .5);\n    expect(b.position).toEqual({ a: 0, bi: 0 });\n    expect(b.velocity).toEqual({ a: 0, bi: 0 });\n  });\n\n  it(\"moves a ball with velocity\", () => {\n    var b = neu();\n    b.velocity = { a: 1, bi: 1 };\n    expect(b.position).toEqual({ a: 0, bi: 0 });\n    expect(b.velocity).toEqual({ a: 1, bi: 1 });\n    b = move(b, 1, 0.2);\n    expect(b.position).toEqual({ a: 1, bi: 1 });\n    expect(b.velocity).toEqual({ a: 0.2, bi: 0.2 });\n  });\n\n});\n"]}